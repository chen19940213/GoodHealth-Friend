{"version":3,"file":"app.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;ACpBA;AAGA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAGA;AACA;AAGA;AACA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AAFA;AAAA;AAAA;AAIA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AAAA;AAAA;AAIA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3GA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAEA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAUA;AACA;AACA;AACA;AACA;AACA;AALA;AAMA;AAEA;AACA;AACA;AAFA;AAKA;AACA;AACA;AACA;AAHA;AAIA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAAA;AAAA;AAQA;AAAA;AAAA;AACA;AACA;AAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;AAAA;AAAA;AASA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AACA;;AAEA;AACA;AACA;AACA;AACA;AAFA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAbA;AAAA;AAAA;AAAA;AAeA;AACA;AACA;AACA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAGA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AACA;AAEA;AAAA;AAAA;AACA;AAGA;AACA;AAEA;AAEA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAEA;AAAA;AAAA;AACA;AAlCA;AAAA;AAAA;AAAA;AAoCA;AACA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AAGA;;;;;;;;;;;;;;;;;;;;;ACzNA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA","sources":["webpack://AppStarCardWXSS/._src_app.tsx","webpack://AppStarCardWXSS/./src/app.tsx?c9a4","webpack://AppStarCardWXSS/._src_common_fusion.tsx","webpack://AppStarCardWXSS/._src_models_appModel.ts","webpack://AppStarCardWXSS/._src_shims_wisdom-config-sdk.ts"],"sourcesContent":["import _classCallCheck from \"C:/Users/\\u9648\\u6587\\u5E94/Desktop/GoodHealth-Friend-main/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/Users/\\u9648\\u6587\\u5E94/Desktop/GoodHealth-Friend-main/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _callSuper from \"C:/Users/\\u9648\\u6587\\u5E94/Desktop/GoodHealth-Friend-main/node_modules/@babel/runtime/helpers/esm/callSuper.js\";\nimport _inherits from \"C:/Users/\\u9648\\u6587\\u5E94/Desktop/GoodHealth-Friend-main/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport Taro from '@tarojs/taro';\nimport React, { Component } from 'react';\nimport { Provider } from 'mobx-react';\nimport appModel from '@/models/appModel';\nimport Native from '@/common/native';\nimport Fusion from '@/common/fusion';\nimport '@/app.scss';\n\n// Ubt 已移除，使用空对象替代\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nvar APM = {\n  pageStartTime: function pageStartTime() {}\n};\nvar PageT = function PageT() {};\n// Fusion 初始化\nFusion.init();\nif (process.env.CODE_ENV !== 'pro') {\n  Taro.setEnableDebug({\n    enableDebug: true\n  });\n}\nvar App = /*#__PURE__*/function (_Component) {\n  function App() {\n    _classCallCheck(this, App);\n    return _callSuper(this, App, arguments);\n  }\n  _inherits(App, _Component);\n  return _createClass(App, [{\n    key: \"onLaunch\",\n    value: function onLaunch(options) {\n      // 版本更新检测\n\n      appModel.checkAppUpdate();\n      // 初始化\n      appModel.init(options);\n    }\n  }, {\n    key: \"componentDidShow\",\n    value: function componentDidShow(options) {\n      if (Native.IS_WEAPP) {\n        appModel.setScene(options);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/_jsx(Provider, {\n        children: this.props.children\n      });\n    }\n  }]);\n}(Component);\nexport default App;","import '@tarojs/plugin-platform-weapp/dist/runtime'\n\nimport { window } from '@tarojs/runtime'\nimport { createReactApp } from '@tarojs/plugin-framework-react/dist/runtime'\nimport { initPxTransform } from '@tarojs/taro'\n\nimport component from \"!!../node_modules/@tarojs/taro-loader/lib/entry-cache.js?name=app!./app.tsx\"\n\nimport * as React from 'react'\nimport ReactDOM from 'react-dom'\n\nvar config = {\"pages\":[\"pages/index/index\",\"pages/calendar-trend/calendar-trend\",\"pages/my/my\",\"pages/identification/identification\",\"pages/camera/camera\",\"pages/appraisal/appraisal\",\"pages/result/result\",\"pages/settings/settings\",\"pages/profile/profile\",\"pages/nickname-edit/nickname-edit\",\"pages/login/login\",\"pages/about/about\"],\"subPackages\":[{\"root\":\"pages/webview\",\"pages\":[\"webview\"]}],\"tabBar\":{\"list\":[{\"iconPath\":\"./assets/tabs/homepage.png\",\"selectedIconPath\":\"./assets/tabs/homepage_selected.png\",\"pagePath\":\"pages/index/index\",\"text\":\"首页\"},{\"iconPath\":\"./assets/tabs/calendar.png\",\"selectedIconPath\":\"./assets/tabs/calendar_selected.png\",\"pagePath\":\"pages/calendar-trend/calendar-trend\",\"text\":\"日历趋势\"},{\"iconPath\":\"./assets/tabs/my.png\",\"selectedIconPath\":\"./assets/tabs/my_selected.png\",\"pagePath\":\"pages/my/my\",\"text\":\"我的\"}],\"color\":\"#879099\",\"selectedColor\":\"#FF5078\",\"backgroundColor\":\"#fff\",\"borderStyle\":\"black\"},\"window\":{\"backgroundTextStyle\":\"light\",\"navigationBarBackgroundColor\":\"#fff\",\"navigationBarTitleText\":\"哈啰\",\"navigationBarTextStyle\":\"black\"}};\nwindow.__taroAppConfig = config\nvar inst = App(createReactApp(component, React, ReactDOM, config))\n\ninitPxTransform({\n  designWidth: 750,\n  deviceRatio: {\"375\":2,\"640\":1.17,\"750\":1,\"828\":0.905},\n  baseFontSize: 20,\n  unitPrecision: undefined,\n  targetUnit: undefined\n})\n","import React from 'react';\nimport {\n  PageSkeleton, Http, Native, ICodeEnv,\n} from '@hb/taro-fusion-components';\nimport Taro from '@tarojs/taro';\nimport Env from '@/common/env';\nimport appConst from '@/constants/app.const';\nimport appModel from '@/models/appModel';\nimport { LoginEvent } from '@/common/events';\nimport loginModel from '@/models/loginModel';\n\nlet mobileInfo = {};\nconst getMobileInfo = () => {\n  if (Object.keys(mobileInfo).length) {\n    return mobileInfo;\n  }\n  try {\n    const {\n      model, system, platform, version,\n    } = Taro.getSystemInfoSync();\n\n    mobileInfo = {\n      mobileVersion: version || 'UNKNOW',\n      mobileModel: model || 'UNKNOW',\n      mobileSystem: system || 'UNKNOW',\n      systemPlatform: platform || 'UNKNOW',\n    };\n    return mobileInfo;\n  } catch {\n    return {\n      mobileVersion: 'UNKNOW',\n      mobileModel: 'UNKNOW',\n      mobileSystem: 'UNKNOW',\n      systemPlatform: 'UNKNOW',\n    };\n  }\n};\n\nconst getHttpBaseParams = () => {\n  const { scene, traceId } = appModel;\n\n  const httpBaseParams = {\n    version: Env.appVersion,\n    appName: Env.appName,\n    $scene: scene,\n    $traceId: traceId,\n    systemCode: appConst.SYSTEM_CODE,\n    ...getMobileInfo(),\n    ...Env.codeEnv !== 'pro' ? {\n      __sysTag: Env.codeEnvTag,\n    } : {},\n  };\n\n  return httpBaseParams;\n};\n\nclass Fusion {\n  // initUbt 已移除，Ubt 功能已禁用\n\n  /**\n   * 初始化PageSkeleton\n   */\n  static initPageSkeleton() {\n    PageSkeleton.setGlobalOptions({\n      // customSlotRender: (props) => {\n      //   const { hideElf } = props.customProps || {};\n      //   // 生产环境不渲染该逻辑\n      //   if (process.env.CODE_ENV !== 'pro' || Number(process.env.IS_CI) !== 1) {\n      //     // eslint-disable-next-line\n      //     const Elf = require('@/components/common/Elf').default;\n      //     return !hideElf && <Elf />;\n      //   }\n      //   return null;\n      // },\n      onPageUnload() {\n        // 移除当前页面的登录监听器\n        LoginEvent.offCurrent();\n      },\n    });\n  }\n\n  /**\n   * 初始化Native\n   */\n  static initNative() {\n    Native.config({\n      shareAppOptions: {\n        shareOriginId: appConst.MINA_ORIGIN_ID,\n      },\n    });\n  }\n\n  static init() {\n    Fusion.initNative();\n    // Fusion.initUbt();\n    Fusion.initPageSkeleton();\n  }\n}\n\n// 注册到 Env 中\nEnv.register((codeEnv: ICodeEnv) => {\n  Taro.nextTick(() => {\n    Native.setCodeEnv(codeEnv);\n    Fusion.init();\n  });\n});\n\nexport default Fusion;\n","import Taro from '@tarojs/taro';\nimport { IGetLocationOptions, Native } from '@hb/taro-fusion-components';\nimport { AppShowOptions, ILocationResult, ILocationOptions } from '@/services/types';\nimport env from '@/common/env';\nimport loginModel from '@/models/loginModel';\nimport appConst from '@/constants/app.const';\n\nconst defaultLocation: ILocationResult = {\n  longitude: '0',\n  latitude: '0',\n  resultType: 1,\n};\n\nclass AppModel {\n  /**\n   * 打开小程序的场景值，由系统分配：\n   * - weapp 官方文档：https://developers.weixin.qq.com/miniprogram/dev/reference/scene-list.html\n   * - alipay 官方文档：https://opendocs.alipay.com/mini/08otyv\n   * - tt 官方文档：https://developer.open-douyin.com/docs/resource/zh-CN/mini-app/develop/framework/scene-value\n   * - mpaas 在链接中自定义：hellobike://hellobike.com/bifrost?name={appName}&appId={appId}&scene={scene}&page={page}\n   * @default 0 - 表示没有获取到scene值\n   */\n  scene = 0;\n\n  /**\n   * 链路跟踪id, 由访问链接携带传入，携带规则见 `setTraceId` 定义\n   * @description 该字段会自动上送到所有接口及埋点中:\n   * - 接口报文：$scene、$traceId\n   * - 埋点：businessInfo: { traceId, scene }\n   */\n  traceId = ''; // 由访问入口传入，跟踪用户访问行为\n\n  /**\n   * 缓存当前位置信息，默认为 null\n   */\n  getLocationPromise: Promise<ILocationResult> | null = null;\n\n  /**\n   * 存放 wisdown 配置信息，配置后启用\n   * @see https://hellobike.yuque.com/gzxsb9/gt85o7/mfwxfq?\n   */\n  wisdomConfig = Object.create(null);\n\n  /**\n   * 初始化小程序\n   */\n  init(options: AppShowOptions) {\n    // 设置小程序 打开场景值\n    this.setScene(options);\n    // 设置小程序访问的traceId\n    this.setTraceId(options);\n    // 初始化登录态\n    loginModel.initAppLogin();\n\n    // 初始化当前定位（可开关）\n    this.getLocation();\n    // 初始化 wisdom（可开关）\n    this.initWisdom();\n  }\n\n  /**\n   * 设置小程序打开的`scene`值（兼容全端）\n   * - 原生小程序：由系统分配（weapp、alipay）\n   * - MPAAS：通过链接地址携带`scene`:\n   * hellobike://hellobike.com/bifrost?name={appName}&appId={appId}&scene={scene}&page={page}\n   * @param options\n   */\n  setScene(options: AppShowOptions) {\n    const { scene, query = {} } = options;\n    // 默认2000\n    const { scene: appscene = -1 } = query;\n\n    // MPAAS 的 scene 从 query 中获取\n    if (Native.IS_MPAAS) {\n      this.scene = +appscene;\n    } else {\n      this.scene = scene;\n    }\n  }\n\n  /**\n   * 设置小程序访问的`traceId`值（兼容全端）\n   * 各场景跳转链接格式如下：\n   * - 小程序码（微信太阳码）: /pages/index/index?traceId={traceId}\n   * - 小自定义二维码（微信）: https://c3x.me/miaowa/index?traceId={traceId}\n   * - MPAAS Scheme: hellobike://hellobike.com/bifrost?name={appName}&appId={appId}&page={encode(pageUrl)}&traceId={traceId}\n   * - 支付宝 Scheme: alipays://platformapi/startapp?appId={appId}&page={encode(pageUrl)}&query={encode(traceId={traceId})}\n   * @param options\n   */\n  setTraceId(options: AppShowOptions) {\n    const { query = {} } = options;\n    // 默认为空，即无traceId\n    const { traceId = '', q } = query;\n    this.traceId = traceId;\n\n    // 兼容微信普通二维码参数获取\n    if (Native.IS_WEAPP && q) {\n      const { traceId: wxTraceId } = Native.getUrlParams({\n        url: decodeURIComponent(q as string),\n      });\n      if (wxTraceId) {\n        this.traceId = wxTraceId;\n      }\n    }\n    // 当全局没有时，从页面参数中获取\n    if (!this.traceId && Native.IS_MPAAS) {\n      Taro.nextTick(() => {\n        const { traceId: pageTraceId } = Native.getUrlParams();\n        if (pageTraceId) {\n          this.traceId = pageTraceId;\n        }\n      });\n    }\n  }\n\n  /**\n   * 初始化 wisdom 配置\n   * @description 配置项参考：https://hellobike.yuque.com/gzxsb9/gt85o7/mfwxfq\n   */\n  async initWisdom() {\n    // 全局不启用 wisdom\n    if (+appConst.WISHDOM_ENABLE === 0) {\n      return;\n    }\n    // eslint-disable-next-line\n    const ClientSDK = require('@hb/wisdom-config-sdk').default;\n\n    const { codeEnv } = env;\n    const clientSDK = () => new ClientSDK({ project: 'AppStarCardWXSS', env: codeEnv });\n    const clientConfigEvent = clientSDK();\n    const wisdownConfig = await clientConfigEvent.getAll();\n    this.wisdomConfig = wisdownConfig || {};\n  }\n\n  /**\n   * 获取地理位置信息\n   * @param fromCache 当对实时性要求不高时，可设置 `fromCache:true`，此时会优先查缓存，以提升获取速度。\n   * @returns ILocationResult\n   */\n  async getLocation(options: ILocationOptions = {}) {\n    const {\n      fromCache = true,\n      ...restOptions\n    } = options;\n\n    // 全局不启用定位\n    if (+appConst.LOCATION_ENABLE === 0) {\n      return Promise.resolve(defaultLocation);\n    }\n\n    if (fromCache) {\n      // 如果有缓存，直接返回缓存\n      if (this.getLocationPromise) {\n        return this.getLocationPromise.then((res) => ({\n          ...res,\n          resultType: 2,\n        }));\n      }\n    }\n    // 重新请求定位\n    this.getLocationPromise = Native.getLocation(\n      restOptions as IGetLocationOptions,\n    ).then((res) => ({\n      ...res,\n      resultType: 0,\n    })).catch(() => {\n      // 本次获取失败，清理缓存，下次重新获取\n      this.getLocationPromise = null;\n      // 返回默认值\n      return defaultLocation;\n    });\n\n    return this.getLocationPromise;\n  }\n\n  /**\n   * 小程序检查更新\n   * @supported weapp\n   */\n  checkAppUpdate() {\n    // 全局不启用检查更新\n    if (+appConst.UPDATE_ENABLE === 0) {\n      return;\n    }\n    if (Taro.canIUse('getUpdateManager')) {\n      const updateManager = Taro.getUpdateManager();\n      updateManager.onCheckForUpdate((res) => {\n        if (res.hasUpdate) {\n          updateManager.onUpdateReady(() => {\n            Taro.showModal({\n              title: '更新提示',\n              content: '新版本已经准备好，是否重启应用？',\n              success(rs) {\n                if (rs.confirm) {\n                  updateManager.applyUpdate();\n                }\n              },\n            });\n          });\n          updateManager.onUpdateFailed(() => {\n            Taro.showModal({\n              title: '已经有新版本了哟~',\n              content: '新版本已经上线啦~，请您删除当前小程序，重新搜索打开哟~',\n            });\n          });\n        }\n      });\n    } else {\n      Taro.showModal({\n        title: '提示',\n        content:\n          '当前微信版本过低，无法更好体验程序，请升级到最新微信版本后重试。',\n      });\n    }\n  }\n}\n\nexport default new AppModel();\n","export default class WisdomClientSDK {\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  constructor(_opts: any) {}\r\n  async getAll() {\r\n    return {} as Record<string, unknown>;\r\n  }\r\n}\r\n\r\n\r\n\r\n"],"names":[],"sourceRoot":""}